---
import SectionWrapper from '../ui/SectionWrapper.astro';
import Button from '../ui/Button.astro';
import ReviewsSection from './ReviewsSection.astro';
import StatsBar from './StatsBar.astro';
import ContactSection from './ContactSection.astro';

interface ServiceCard {
  title: string;
  description: string;
}

interface FAQ {
  question: string;
  answer: string;
}

interface WhyChooseCard {
  title: string;
  description: string;
}

interface Props {
  heroTitle: string;
  heroTitleAccent?: string;
  heroDescription: string;
  heroImage?: string;
  servicesTitle: string;
  servicesIntro?: string;
  serviceCards: ServiceCard[];
  ctaText: string;
  ctaButton: string;
  whyChooseTitle: string;
  whyChooseIntro: string;
  whyChooseCards: WhyChooseCard[];
  faqs: FAQ[];
  bottomCtaText: string;
  bottomCtaButton: string;
  extraSection?: string;
}

const {
  heroTitle,
  heroTitleAccent,
  heroDescription,
  heroImage,
  servicesTitle,
  servicesIntro,
  serviceCards,
  ctaText,
  ctaButton,
  whyChooseTitle,
  whyChooseIntro,
  whyChooseCards,
  faqs,
  bottomCtaText,
  bottomCtaButton,
} = Astro.props;

const faqSchema = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: faqs.map((faq) => ({
    '@type': 'Question',
    name: faq.question,
    acceptedAnswer: {
      '@type': 'Answer',
      text: faq.answer,
    },
  })),
};
---

<!-- Hero -->
<section class="relative overflow-hidden">
  <div class="absolute inset-0">
    {heroImage ? (
      <img
        src={heroImage}
        alt=""
        class="w-full h-full object-cover"
        loading="eager"
      />
    ) : (
      <div class="w-full h-full bg-neutral-400"></div>
    )}
    <div class="absolute inset-0 bg-[#b8bcbb]/75 backdrop-blur-sm"></div>
  </div>
  <div class="relative z-10 mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-24 md:py-32">
    <div class="max-w-4xl mx-auto text-center">
      <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-primary-500">
        {heroTitle}{heroTitleAccent && <> <span class="text-accent-500">{heroTitleAccent}</span></>}
      </h1>
    </div>
  </div>
</section>

<!-- Intro Section -->
<SectionWrapper bgColor="light" padding="md">
  <div class="animate-on-scroll">
    <p class="text-neutral-700 text-lg leading-relaxed border-l-4 border-accent-500 pl-6">
      {heroDescription}
    </p>
  </div>
</SectionWrapper>

<!-- Service Cards -->
<SectionWrapper bgColor="white">
  <div class="text-center mb-12 animate-on-scroll">
    <p class="text-accent-500 font-semibold text-sm uppercase tracking-wide mb-2">What We Offer</p>
    <h2 class="text-3xl md:text-4xl font-bold mb-4">{servicesTitle}</h2>
    {servicesIntro && <p class="text-neutral-600 text-lg max-w-3xl mx-auto">{servicesIntro}</p>}
  </div>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    {
      serviceCards.map((card, i) => (
        <div class:list={['animate-on-scroll', i > 0 && `delay-${i * 100}`]}>
          <div class="bg-white rounded-xl p-8 border-l-4 border-accent-500 shadow-sm hover:-translate-y-1 hover:shadow-lg transition-all duration-300 h-full">
            <h3 class="text-xl font-bold text-primary-500 mb-3">{card.title}</h3>
            <p class="text-neutral-600 leading-relaxed">{card.description}</p>
          </div>
        </div>
      ))
    }
  </div>
  <div class="text-center mt-10 animate-on-scroll delay-400">
    <div class="border-t border-neutral-200 pt-8">
      <p class="text-neutral-700 text-lg mb-4">{ctaText}</p>
      <Button href="/contact-us/" variant="primary" size="lg">{ctaButton}</Button>
    </div>
  </div>
</SectionWrapper>

<!-- Trusted / Why Choose -->
<SectionWrapper bgColor="white">
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-16 items-center">
    <!-- Left: Image with Decorative Elements -->
    <div class="relative animate-on-scroll delay-200">
      <!-- Decorative accent shape behind image -->
      <div class="absolute -top-4 -left-4 w-full h-full rounded-2xl bg-accent-500/10 hidden lg:block"></div>

      <!-- Main image -->
      <img
        src="/images/team-group.jpg"
        alt="Magnified SMSF Specialists team"
        class="relative w-full rounded-2xl shadow-2xl ring-1 ring-neutral-200 max-h-[550px] object-cover"
        loading="lazy"
      />

      <!-- Overlapping experience badge -->
      <div class="absolute -bottom-6 left-8 lg:left-12 -right-4 bg-accent-500 rounded-xl p-5 shadow-xl">
        <div class="flex items-center gap-3">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white/60 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg>
          <div>
            <p class="text-white font-semibold text-sm">18+ Years of SMSF Expertise</p>
            <p class="text-white/80 text-sm">Your Local Expert Partner in Perth & Mandurah</p>
          </div>
        </div>
      </div>

      <!-- Bottom spacer for overlapping card -->
      <div class="h-10"></div>
    </div>

    <!-- Right: Text Content -->
    <div>
      <p class="text-accent-500 font-semibold text-sm uppercase tracking-wide mb-2 animate-on-scroll">Why Choose Us</p>
      <h2 class="text-3xl md:text-4xl font-bold mb-6 animate-on-scroll delay-100">
        {whyChooseTitle}
      </h2>

      <!-- Lead paragraph with accent left border -->
      <div class="border-l-4 border-accent-500 pl-5 mb-6 animate-on-scroll delay-200">
        <p class="text-neutral-700 text-lg leading-relaxed">
          {whyChooseIntro}
        </p>
      </div>

      <ul class="space-y-4 mb-6 animate-on-scroll delay-300">
        {
          whyChooseCards.map((card) => (
            <li class="flex items-start gap-3">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-accent-500 flex-shrink-0 mt-0.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg>
              <div>
                <span class="text-primary-500 font-semibold">{card.title}</span>
                <p class="text-neutral-600 text-sm mt-0.5">{card.description}</p>
              </div>
            </li>
          ))
        }
      </ul>

      <div class="border-t border-neutral-200 pt-6 animate-on-scroll delay-400">
        <Button href="/contact-us/" variant="primary" size="lg">
          Discover the Magnified Difference
        </Button>
      </div>
    </div>
  </div>
</SectionWrapper>

<!-- FAQ Schema -->
<script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />

<!-- FAQs + CTA -->
<SectionWrapper bgColor="white">
  <div class="grid grid-cols-1 lg:grid-cols-5 gap-12 lg:gap-16">
    <!-- Left: FAQs -->
    <div class="lg:col-span-3 animate-on-scroll">
      <h2 class="text-3xl md:text-4xl font-bold mb-8">Frequently Asked Questions</h2>
      <div class="space-y-4">
        {
          faqs.map((faq) => (
            <details class="group bg-neutral-50 rounded-xl border border-neutral-200 overflow-hidden">
              <summary class="flex items-center justify-between cursor-pointer p-6 font-semibold text-primary-500 hover:bg-neutral-100 transition-colors">
                {faq.question}
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 flex-shrink-0 transition-transform group-open:rotate-180" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"></path></svg>
              </summary>
              <div class="px-6 pb-6 text-neutral-600 leading-relaxed">{faq.answer}</div>
            </details>
          ))
        }
      </div>
    </div>

    <!-- Right: CTA Card -->
    <div class="lg:col-span-2 animate-on-scroll delay-200">
      <div class="bg-accent-500 rounded-2xl p-8 lg:sticky lg:top-24">
        <h3 class="text-2xl font-bold text-white mb-4">Take The Next Step</h3>
        <p class="text-white/85 text-lg leading-relaxed mb-6">{bottomCtaText}</p>
        <Button href="/contact-us/" variant="white" size="lg" class="w-full">
          {bottomCtaButton}
        </Button>
      </div>
    </div>
  </div>
</SectionWrapper>

<!-- Extra content slot -->
<slot />

<!-- Reviews -->
<ReviewsSection />

<!-- Trust Badges -->
<StatsBar bgColor="accent" showTagline={false} showIcons={false} />

<!-- Contact -->
<ContactSection />
