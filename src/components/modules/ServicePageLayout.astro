---
import SectionWrapper from '../ui/SectionWrapper.astro';
import Button from '../ui/Button.astro';
import ReviewsSection from './ReviewsSection.astro';
import StatsBar from './StatsBar.astro';
import ContactSection from './ContactSection.astro';

interface ServiceCard {
  title: string;
  description: string;
}

interface FAQ {
  question: string;
  answer: string;
}

interface WhyChooseCard {
  title: string;
  description: string;
}

interface Props {
  heroTitle: string;
  heroDescription: string;
  heroImage?: string;
  servicesTitle: string;
  servicesIntro?: string;
  serviceCards: ServiceCard[];
  ctaText: string;
  ctaButton: string;
  whyChooseTitle: string;
  whyChooseIntro: string;
  whyChooseCards: WhyChooseCard[];
  faqs: FAQ[];
  bottomCtaText: string;
  bottomCtaButton: string;
  extraSection?: string;
}

const {
  heroTitle,
  heroDescription,
  heroImage,
  servicesTitle,
  servicesIntro,
  serviceCards,
  ctaText,
  ctaButton,
  whyChooseTitle,
  whyChooseIntro,
  whyChooseCards,
  faqs,
  bottomCtaText,
  bottomCtaButton,
} = Astro.props;

const faqSchema = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: faqs.map((faq) => ({
    '@type': 'Question',
    name: faq.question,
    acceptedAnswer: {
      '@type': 'Answer',
      text: faq.answer,
    },
  })),
};
---

<!-- Hero -->
<section class="relative overflow-hidden">
  <div class="absolute inset-0">
    {heroImage ? (
      <img
        src={heroImage}
        alt=""
        class="w-full h-full object-cover"
        loading="eager"
      />
    ) : (
      <div class="w-full h-full bg-neutral-400"></div>
    )}
    <div class="absolute inset-0 bg-[#b8bcbb]/75 backdrop-blur-sm"></div>
  </div>
  <div class="relative z-10 mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-24 md:py-32">
    <div class="max-w-4xl mx-auto text-center">
      <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-primary-500 mb-4">{heroTitle}</h1>
      <p class="text-lg md:text-xl text-primary-500/80 font-light max-w-3xl mx-auto">{heroDescription}</p>
    </div>
  </div>
</section>

<!-- Service Cards -->
<SectionWrapper bgColor="white">
  <div class="text-center mb-12">
    <h2 class="text-3xl md:text-4xl font-bold mb-4">{servicesTitle}</h2>
    {servicesIntro && <p class="text-neutral-600 text-lg max-w-3xl mx-auto">{servicesIntro}</p>}
  </div>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    {
      serviceCards.map((card) => (
        <div class="bg-neutral-50 rounded-xl p-8 border border-neutral-100 hover:shadow-md transition-shadow">
          <h3 class="text-xl font-bold text-primary-500 mb-3">{card.title}</h3>
          <p class="text-neutral-600 leading-relaxed">{card.description}</p>
        </div>
      ))
    }
  </div>
  <div class="text-center mt-10">
    <p class="text-neutral-700 text-lg mb-4">{ctaText}</p>
    <Button href="/contact-us/" variant="primary" size="lg">{ctaButton}</Button>
  </div>
</SectionWrapper>

<!-- Trusted / Why Choose -->
<SectionWrapper bgColor="light">
  <div class="text-center mb-12">
    <p class="text-accent-500 font-semibold text-sm uppercase tracking-wide mb-2">Trusted by Perth's Professionals</p>
    <h2 class="text-3xl md:text-4xl font-bold mb-4">{whyChooseTitle}</h2>
    <p class="text-neutral-600 text-lg max-w-2xl mx-auto">{whyChooseIntro}</p>
  </div>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    {
      whyChooseCards.map((card) => (
        <div class="bg-white rounded-xl p-8 shadow-sm">
          <h3 class="text-xl font-bold text-primary-500 mb-3">{card.title}</h3>
          <p class="text-neutral-600">{card.description}</p>
        </div>
      ))
    }
  </div>
</SectionWrapper>

<!-- FAQ Schema -->
<script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />

<!-- FAQs -->
<SectionWrapper bgColor="white">
  <div class="max-w-3xl mx-auto">
    <h2 class="text-3xl md:text-4xl font-bold text-center mb-10">Frequently Asked Questions</h2>
    <div class="space-y-4">
      {
        faqs.map((faq) => (
          <details class="group bg-neutral-50 rounded-xl border border-neutral-200 overflow-hidden">
            <summary class="flex items-center justify-between cursor-pointer p-6 font-semibold text-primary-500 hover:bg-neutral-100 transition-colors">
              {faq.question}
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 flex-shrink-0 transition-transform group-open:rotate-180" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"></path></svg>
            </summary>
            <div class="px-6 pb-6 text-neutral-600 leading-relaxed">{faq.answer}</div>
          </details>
        ))
      }
    </div>
  </div>
</SectionWrapper>

<!-- Bottom CTA -->
<SectionWrapper bgColor="primary" padding="md">
  <div class="max-w-3xl mx-auto text-center">
    <h2 class="text-3xl font-bold text-white mb-4">Take The Next Step</h2>
    <p class="text-primary-100 text-lg mb-6">{bottomCtaText}</p>
    <Button href="/contact-us/" variant="primary" size="lg">{bottomCtaButton}</Button>
  </div>
</SectionWrapper>

<!-- Extra content slot -->
<slot />

<!-- Reviews -->
<ReviewsSection />

<!-- Trust Badges -->
<StatsBar bgColor="white" showTagline={false} showIcons={false} />

<!-- Contact -->
<ContactSection />
